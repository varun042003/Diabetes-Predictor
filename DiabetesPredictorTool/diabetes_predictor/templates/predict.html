{% extends "layout.html" %}

{% block title %}Predict Your Risk{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            <div class="card">
                <div class="card-header">
                    <h3 class="mb-0"><i class="fas fa-calculator me-2 text-info"></i>Diabetes Risk Prediction</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>
                        Please fill out the form below with your health information. The more accurate your inputs, the better the prediction.
                    </div>
                    
                    <form id="prediction-form" class="prediction-form" method="POST" action="{{ url_for('predict') }}">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="pregnancies" class="form-label">Number of Pregnancies</label>
                                <input type="number" class="form-control" id="pregnancies" name="pregnancies" 
                                       min="0" max="20" value="0">
                                <small class="text-body-secondary">For males, enter 0</small>
                                <div class="invalid-feedback">Please enter a valid number</div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="glucose" class="form-label">Glucose Level (mg/dL) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="glucose" name="glucose" 
                                       min="70" max="300" placeholder="70-300" required>
                                <small class="text-body-secondary">Normal fasting glucose is 70-100 mg/dL</small>
                                <div class="invalid-feedback">Please enter a valid glucose level</div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="blood_pressure" class="form-label">Blood Pressure (mm Hg) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="blood_pressure" name="blood_pressure" 
                                       min="60" max="200" placeholder="60-200" required>
                                <small class="text-body-secondary">Diastolic (bottom number)</small>
                                <div class="invalid-feedback">Please enter a valid blood pressure</div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="skin_thickness" class="form-label">Skin Thickness (mm)</label>
                                <input type="number" class="form-control" id="skin_thickness" name="skin_thickness" 
                                       min="0" max="100" placeholder="0-100">
                                <small class="text-body-secondary">Triceps skin fold thickness</small>
                                <div class="invalid-feedback">Please enter a valid skin thickness</div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="insulin" class="form-label">Insulin (μU/ml)</label>
                                <input type="number" class="form-control" id="insulin" name="insulin" 
                                       min="0" max="900" placeholder="0-900">
                                <small class="text-body-secondary">2-Hour serum insulin</small>
                                <div class="invalid-feedback">Please enter a valid insulin level</div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="bmi" class="form-label">BMI (kg/m²) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="bmi" name="bmi" 
                                       min="15" max="50" step="0.1" placeholder="15-50" required>
                                <small class="text-body-secondary">Body Mass Index</small>
                                <div class="invalid-feedback">Please enter a valid BMI</div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="diabetes_pedigree" class="form-label">Diabetes Pedigree Function <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="diabetes_pedigree" name="diabetes_pedigree" 
                                       min="0.1" max="2.5" step="0.01" placeholder="0.1-2.5" required>
                                <small class="text-body-secondary">Diabetes family history score</small>
                                <div class="invalid-feedback">Please enter a valid value (0.1-2.5)</div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <label for="age" class="form-label">Age (years) <span class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="age" name="age" 
                                       min="18" max="120" placeholder="18+" required>
                                <small class="text-body-secondary">Must be at least 18 years old</small>
                                <div class="invalid-feedback">Please enter a valid age (18+)</div>
                            </div>
                        </div>
                        
                        <div class="alert alert-warning mt-3">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            Fields marked with <span class="text-danger">*</span> are required for an accurate prediction.
                        </div>
                        
                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn btn-primary btn-lg animate-pulse">
                                <i class="fas fa-check-circle me-2"></i>Check My Risk
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-calculator me-2 text-info"></i>BMI Calculator</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <label for="height" class="form-label">Height (cm)</label>
                            <input type="number" class="form-control" id="height" min="100" max="250" placeholder="e.g., 170">
                        </div>
                        <div class="col-md-6">
                            <label for="weight" class="form-label">Weight (kg)</label>
                            <input type="number" class="form-control" id="weight" min="30" max="300" placeholder="e.g., 70">
                        </div>
                    </div>
                    <div class="d-grid gap-2 mt-3">
                        <button type="button" class="btn btn-outline-primary" onclick="calculateBMI()">Calculate BMI</button>
                    </div>
                    <div id="bmi-result" class="mt-3 text-center" style="display: none;">
                        <h5>Your BMI: <span id="bmi-value"></span></h5>
                        <p id="bmi-category" class="mb-0"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    function calculateBMI() {
        const height = document.getElementById('height').value;
        const weight = document.getElementById('weight').value;
        
        if (height && weight) {
            const heightInMeters = height / 100;
            const bmi = weight / (heightInMeters * heightInMeters);
            const roundedBMI = bmi.toFixed(1);
            document.getElementById('bmi').value = roundedBMI;
            document.getElementById('bmi-value').textContent = roundedBMI;
            let category = '';
            let categoryClass = '';
            
            if (bmi < 18.5) {
                category = 'Underweight';
                categoryClass = 'text-info';
            } else if (bmi < 25) {
                category = 'Normal weight';
                categoryClass = 'text-success';
            } else if (bmi < 30) {
                category = 'Overweight';
                categoryClass = 'text-warning';
            } else {
                category = 'Obesity';
                categoryClass = 'text-danger';
            }
            
            const categoryElement = document.getElementById('bmi-category');
            categoryElement.textContent = `Category: ${category}`;
            categoryElement.className = categoryClass + ' mb-0';
            document.getElementById('bmi-result').style.display = 'block';
        }
    }
</script>
{% endblock %}
{% endblock %}